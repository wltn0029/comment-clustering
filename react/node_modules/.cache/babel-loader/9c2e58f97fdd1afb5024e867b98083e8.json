{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jisu/comment-clustering/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/jisu/comment-clustering/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/jisu/comment-clustering/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/jisu/comment-clustering/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jisu/comment-clustering/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/jisu/comment-clustering/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/jisu/comment-clustering/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{Component}from'react';import axios from'axios';import CommentThread from'./CommentThread';import CommentThreadCss from'./CommentThread.css';var apiKey='AIzaSyBhrKlcf07TRvzF5RPeKOxYSBC06TP-JUc';var getCommentThreads=function getCommentThreads(videoId){return\"https://www.googleapis.com/youtube/v3/commentThreads?part=snippet&key=\".concat(apiKey,\"                                        &videoId=\").concat(videoId,\"&maxResults=100\");};var requestUrl='143.248.144.129:8080/main';var Comments=/*#__PURE__*/function(_Component){_inherits(Comments,_Component);var _super=_createSuper(Comments);function Comments(props){var _this;_classCallCheck(this,Comments);_this=_super.call(this,props);_this.analyzeComments=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(videoId){var comments,convertedComments,postBody,requestMetadata;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(videoId){_context.next=2;break;}return _context.abrupt(\"return\");case 2:_context.next=4;return axios.get(getCommentThreads(videoId));case 4:comments=_context.sent;convertedComments=comments.data.items.map(function(comment){var id=comment.snippet.topLevelComment.id;var _comment$snippet$topL=_objectSpread({},comment.snippet.topLevelComment.snippet),authorDisplayName=_comment$snippet$topL.authorDisplayName,authorProfileImageUrl=_comment$snippet$topL.authorProfileImageUrl,textOriginal=_comment$snippet$topL.textOriginal;return{id:id,authorDisplayName:authorDisplayName,authorProfileImageUrl:authorProfileImageUrl,textOriginal:textOriginal};});console.log(convertedComments);// Request : send comments to server to get sentimental results\n// method : POST\n// body : { rawData : convertedComments }\n// response : {pos : commentsList, neg : commentList, neu : commentList }\npostBody={rawData:convertedComments};requestMetadata={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(postBody)};fetch(requestUrl,requestMetadata).then(function(res){//todo : fetch server's response and render it  \n});_this.setState({pos:convertedComments});case 11:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.isSelected=function(category){if(_this.state.selectedCategory===''){return false;}else if(_this.state.selectedCategory===category){return true;}else{return undefined;}};_this.expandCommentThreads=function(category){console.log('expandcommentthread',category);_this.setState({selectedCategory:category});};_this.state={neg:[],pos:[],neu:[],selectedCategory:''};return _this;}_createClass(Comments,[{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps,nextState){if(nextProps.videoId!==this.props.videoId){this.analyzeComments(nextProps.videoId);return true;}else if(nextState.neg!==this.state.neg||nextState.pos!==this.state.pos||nextState.neu!==this.state.neu||nextState.selectedCategory!==this.state.selectedCategory){return true;}return false;}},{key:\"render\",value:function render(){var _this$state=this.state,pos=_this$state.pos,neg=_this$state.neg,neu=_this$state.neu;return/*#__PURE__*/_jsx(\"div\",{className:\"comments\",children:(pos.length!==0||neg.length!==0||neu.length!==0)&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CommentThread,{category:\"pos\",comments:this.state.pos,expand:this.isSelected(\"pos\"),handleClick:this.expandCommentThreads}),/*#__PURE__*/_jsx(CommentThread,{category:\"neu\",comments:this.state.neu,expand:this.isSelected(\"neu\"),handleClick:this.expandCommentThreads}),/*#__PURE__*/_jsx(CommentThread,{category:\"neg\",comments:this.state.neg,expand:this.isSelected(\"neg\"),handleClick:this.expandCommentThreads})]})});}}]);return Comments;}(Component);export default Comments;","map":{"version":3,"sources":["/Users/jisu/comment-clustering/react/src/components/Comments.js"],"names":["React","Component","axios","CommentThread","CommentThreadCss","apiKey","getCommentThreads","videoId","requestUrl","Comments","props","analyzeComments","get","comments","convertedComments","data","items","map","comment","id","snippet","topLevelComment","authorDisplayName","authorProfileImageUrl","textOriginal","console","log","postBody","rawData","requestMetadata","method","headers","body","JSON","stringify","fetch","then","res","setState","pos","isSelected","category","state","selectedCategory","undefined","expandCommentThreads","neg","neu","nextProps","nextState","length"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport CommentThread from './CommentThread';\nimport CommentThreadCss from './CommentThread.css';\n\nconst apiKey = 'AIzaSyBhrKlcf07TRvzF5RPeKOxYSBC06TP-JUc';\nconst getCommentThreads = videoId => `https://www.googleapis.com/youtube/v3/commentThreads?part=snippet&key=${apiKey}\\\n                                        &videoId=${videoId}&maxResults=100`;\nconst requestUrl = '143.248.144.129:8080/main';\nclass Comments extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            neg : [],\n            pos : [],\n            neu : [],\n            selectedCategory: ''\n        }\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        if (nextProps.videoId !== this.props.videoId) {\n            this.analyzeComments(nextProps.videoId);\n            return true;\n        } else if (nextState.neg !== this.state.neg ||\n                    nextState.pos !== this.state.pos ||\n                    nextState.neu !== this.state.neu || \n                    nextState.selectedCategory !== this.state.selectedCategory) {\n            return true\n        }\n        return false;\n    }\n\n    analyzeComments = async(videoId) => {\n        if (!videoId) {\n            return;\n        }\n        const comments = await axios.get(getCommentThreads(videoId));\n        const convertedComments = comments.data.items.map(comment => {\n            const id = comment.snippet.topLevelComment.id\n            const {authorDisplayName, authorProfileImageUrl, textOriginal} = \n                {...comment.snippet.topLevelComment.snippet}\n            return {id, authorDisplayName, authorProfileImageUrl, textOriginal}\n        })\n        console.log(convertedComments)\n        \n        // Request : send comments to server to get sentimental results\n        // method : POST\n        // body : { rawData : convertedComments }\n        // response : {pos : commentsList, neg : commentList, neu : commentList }\n        const postBody = {\n            rawData : convertedComments \n        };\n        const requestMetadata = {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(postBody)\n        };\n    \n        fetch(requestUrl, requestMetadata)\n            .then(res => {\n                //todo : fetch server's response and render it  \n            })\n\n        this.setState({\n            pos: convertedComments\n        })\n    }\n\n    // category \n    // pos : expand positive comments\n    // neu : expand neutral comments\n    // neg : expand negative comments\n    // '' : nothing to expand \n    isSelected = (category) => {\n        if (this.state.selectedCategory === '') {\n            return false;\n        } else if (this.state.selectedCategory === category) {\n            return true;\n        } else {\n            return undefined;\n        }\n    }\n\n    expandCommentThreads = (category) => {\n        console.log('expandcommentthread', category)\n        this.setState({selectedCategory: category})\n    }\n\n    render() {\n        const {pos, neg, neu} = this.state;\n        return (\n            <div className=\"comments\">\n                {(pos.length !==0 || neg.length !== 0 || neu.length !== 0) && (\n                    <div>\n                        <CommentThread category=\"pos\" comments={this.state.pos}\n                            expand={this.isSelected(\"pos\")} handleClick={this.expandCommentThreads}/>\n                        <CommentThread category=\"neu\" comments={this.state.neu} \n                            expand={this.isSelected(\"neu\")} handleClick={this.expandCommentThreads}/>\n                        <CommentThread category=\"neg\" comments={this.state.neg} \n                            expand={this.isSelected(\"neg\")} handleClick={this.expandCommentThreads}/>\n                    </div>\n                ) }\n            </div>\n        );\n    }\n}\n\nexport default Comments;"]},"metadata":{},"sourceType":"module"}